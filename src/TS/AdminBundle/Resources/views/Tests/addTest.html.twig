{# src/TS/AdminBundle/Resources/views/Tests/addTest.html.twig #}
<div class="row">
    <div class="col-md-12">
        <div style="margin: 20px" id="big-box#" class="content-box box-toggle content-box-closed">
            <h3 class="content-box-header ui-state-default">
                <span class="float-left">Add a new test</span>
                <a class="float-right icon-separator btn toggle-button">
                    <i id="big-box" onclick="changeElement(this);" class="glyph-icon icon-toggle icon-chevron-down"></i>
                </a>
            </h3>
            <div  class="content-box-wrapper">
                <form class="col-md-10 center-margin" method="post"{{ form_enctype(form) }}>
                    <div class="form-row">
                        <div class="form-input col-md-2">
                            <label for="">
                                {{ form_label(form.name) }}
                                <span class="required" style="color:red">*</span>
                            </label>
                        </div>
                        <div class="form-input col-md-10" >
                            {{ form_widget(form.name) }}
                        </div>
                    </div>
                    <div class="form-row" >
                        <div class="form-input col-md-2">
                            <label for="">
                                type
                                <span class="required" style="color:red">*</span>
                            </label>
                        </div>
                        <div  class="form-input col-md-10">
                            <select required="required" id="choice" name="type" class="chosen-select" onchange="checkTest(this.value);">
                                <option > </option>
                                {% for thisTest in allTests %}
                                    <option  value={{thisTest.name}} >
                                        {{thisTest.name}}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-input col-md-2">
                            {{ form_label(form.note) }}
                            <span class="required" style="color:red">*</span>
                        </div>
                        <div class="form-input col-md-4">
                            {{ form_widget(form.note) }}
                        </div>
                        <div class="form-input col-md-2">
                            {{ form_label(form.eliminatoryNote) }}
                            <span class="required" style="color:red">*</span>
                        </div>
                        <div class="form-input col-md-4">
                            {{ form_widget(form.eliminatoryNote) }}
                        </div>
                    </div>
                      <div class="form-row">
                        <div class="form-input col-md-2">
                            <label for="">
                                {{ form_label(form.time) }} (in minutes)
                                <span class="required" style="color:red">*</span>
                            </label>
                        </div>
                        <div class="form-input col-md-10" >
                            {{ form_widget(form.time) }}
                        </div>
                    </div>    
                    <div class="form-row">
                        <div class="form-input col-md-2">
                            <label for="">
                                questions
                                <span class="required"  style="color:red" >*</span>
                            </label>
                        </div>
                        <div id="questions" class="form-input col-md-10">
                            <table class="table text-center">
                                <thead>
                                    <tr>
                                        <th class="text-center"></th>
                                        <th>Question </th>
                                        <th></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for question in questions %}
                                        <tr  id="{{question.id}}"  style="display: none">
                                            <td>
                                                <a href="javascript:;" title="" class="btn medium primary-bg" data-toggle="dropdown">
                                                    <i class="glyph-icon icon-chevron-down"></i>
                                                </a>
                                            </td>
                                            <td>
                                                {{question.tests}}
                                                <label for="{{question.id}}"> 
                                                    <b class="font-bold text-left" id="text{{question.id}}"></b>
                                                    <script type = "text/javascript">
                                                        $('b#text{{question.id}}').append({{ question.text|json_encode|raw}});</script>
                                                </label>
                                                <br/>
                                            </td>
                                            <td>
                                                <div class="label bg-red">{{question.note}}</div>
                                            </td>
                                            <td>
                                                <div class="form-checkbox-radio col-md-12">
                                                    <div class="checkbox-radio">
                                                        <input id="check" class="right" value="{{question.id}}" type="checkbox" name="ids[]" onClick="incrementMark(this);">
                                                        <script>
                                                            function incrementMark(_this) {
                                                                var input{{question.id}} = document.getElementById(_this.id);
                                                                var mark = document.getElementById("ts_adminbundle_tests_note");
                                                                 alert({{question.note}});
                                                            {#                                                                var note = Number({{question.note}});#}
                                                                    if (input{{question.id}}.checked === true) {
                                                                        alert('bon');
                                                            {# var markNote1 = Number(mark.value);
                                                             alert(markNote1);#}
                                                                         alert({{question.note}});
                                                                         alert(Number(mark{{question.id}}.value));
                                                                         var markNote1{{question.id}} = Number({{question.note}}) + Number(mark.value);
                                                                         alert(markNote1);
                                                            {# mark.value = markNote1;
                                                             alert(mark.value);#}
                                                                     }
                                                                     else if (input{{question.id}}.checked === false) {
                                                                         alert('jour2');
                                                            {# var markNote = Number(mark.value);
                                                             alert(markNote);#}
                                                                         alert({{question.note}});
                                                                         alert(Number(mark{{question.id}}.value));
                                                                         var markNote = Number({{question.note}}) - Number(mark.value);
                                                                         alert(markNote);
                                                            {#mark.value = markNote;
                                                            alert(mark.value);#}
                                                                    }
                                                                    ;
                                                                }
                                                        </script>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="divider" ></div>
                        <input type="hidden" name="superhidden" id="superhidden">
                        <div class="col-md-4 col-md-offset-4">
                            <input type="submit" value="ADD" name="submitAction" class="btn medium primary-bg radius-all-4" />
                        </div>
                    </div>
                    {{ form_rest(form) }}
                    {% include "TSAdminBundle:Tests:formulaire.html.twig"  %}
                </form>
            </div>
        </div>
    </div>
</div>
<script>

    function changeElement(_this)
    {
        var div = document.getElementById(_this.id + '#');
        var div2 = document.getElementById(_this.id);
        if (div.className === "content-box box-toggle content-box-closed") {
            div2.className = "glyph-icon icon-toggle icon-chevron-up";
            div.className = "content-box box-toggle";
        }
        else {
            div2.className = "glyph-icon icon-toggle icon-chevron-down";
            div.className = "content-box box-toggle content-box-closed";
        }
    }
    function checkTest(_this) {
    {% for question in questions %}
            var tr{{question.id}} = document.getElementById("{{question.id}}");
            if ((_this) === "{{question.tests}}") {
                tr{{question.id}}.style.display = "";
            }
            else {
                tr{{question.id}}.style.display = "none";
            }
    {% endfor %}
        }
</script>